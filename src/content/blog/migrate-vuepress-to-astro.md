---
title: Claude Codeのチーム機能でブログをVuePressからAstroに移行した
description: Claude Codeのエージェントチーム機能を使い、VuePress 1.xからAstro v5への移行を4つのタスクに分けて進めた記録。
date: 2026-02-08
categories:
  - Astro
tags:
  - VuePress
  - Astro
  - Cloudflare Pages
  - Claude Code
permalink: /migrate-vuepress-to-astro
published: true
---

## 背景

このブログはVuePress 1.xで作り、Firebase Hostingにデプロイしていた。最後の更新は2022年8月。3年半放置していた。久しぶりに触るとNode.jsのバージョン違いでビルドが通らず、記事を書くより環境の修復に時間がかかる状態だった。おいおい。

Astro v5 + Cloudflare Pagesに移行することにした。移行作業にはClaude Codeのエージェントチーム機能を使った。

## チーム機能とは

Claude Codeには複数のエージェントをチームとして起動し、タスクを分担させる機能がある。自分が対話しているエージェント（チームリーダー）がタスクを定義し、専用のエージェントを割り当てて実行させる。

自分が言ったのは「claude teamsを作って移行プロジェクトを進めたい」だけ。タスクの分割、依存関係の設定、各エージェントへの指示は全てチームリーダーが決めた。

チームリーダーが定義した4タスク。

```
#1 VuePressサイトの分析 → #2 Astroセットアップ → #3 記事変換 → #4 デプロイ設定
```

タスク間に依存関係が設定され、#2は#1の完了後に開始、#3は#1と#2の完了後に開始、という流れになった。

## 4つのタスク

**#1 VuePressサイトの分析。** `analyzer`エージェントが73記事のfrontmatter、VuePress固有記法の使用箇所、画像の参照パス、カテゴリの表記揺れを調べ上げた。この分析結果が後続タスクの精度を決めた。

**#2 Astroプロジェクトのセットアップ。** `builder`エージェントがAstro公式テンプレートをベースに、Content Collectionsのスキーマ定義、パーマリンク維持、カテゴリページ、RSS、サイトマップを設定した。分析で判明した「descriptionが空の記事が5件ある」という情報から、スキーマを`nullable()`にする判断まで自動で行われた。

**#3 記事変換。** `migrator`エージェントがNode.jsの変換スクリプトを自前で作成し、VuePress固有記法の削除、画像パスの書き換え、カテゴリ名の統一など、73記事と128画像を一括変換した。ビルドが通ることも確認してから完了報告が来た。

**#4 デプロイ設定。** `deployer`エージェントがパーマリンクの検証、カテゴリページの動作確認、Cloudflare Pagesの設定情報をまとめた。

## コーディング作業はこれだけだった

「claude teamsを作って移行プロジェクトを進めたい」と言って、途中でチームリーダーに聞かれた4つの質問（デプロイ先、画像配置、カテゴリ統一ルール、テンプレート選択）に答えただけで、コーディングに関わる作業は終わった。

残りはスタードメインのネームサーバー変更とCloudflareダッシュボード上でのDNS設定、カスタムドメインの紐付けだけだった。これらはブラウザ上の手作業になる。

## チーム機能を使ってみた感想

**タスク分割を任せられる。** 自分は「移行したい」と言っただけで、チームリーダーが分析・セットアップ・変換・デプロイの4タスクに分割し、依存関係まで設定した。何をどの順番でやるかを考える必要がなかった。

**進捗は見えにくい。** バックグラウンドで動いているエージェントが今何をしているかがわからない。ファイルの変化を直接見るくらいしか手段がなかった。

## まとめ

コーディング作業は一行も書かずに終わった。移行が早く終わったのは間違いないが、所要時間を計測していなかったのはもったいなかった。次回に向けてタイムスタンプを記録するhookを仕込んだ。

移行して良かったのは2つ。記事が `# {{ $page.title }}` や `<PostMeta/>` のないシンプルなMarkdownになったこと。どのエディタでもプレビューできるし、次の移行も楽になる。もう1つはデプロイで、Cloudflare PagesのGitHub連携でpushすれば自動で反映される。Firebase Hostingのときのように手動でコマンドを叩く必要がなくなった。

また3年後にブログ更新しようと思う。
